<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Milo Pha ƒê√°</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <style>
    :root{
      --bg: #0b1020;
      --card: rgba(18,28,48,.68);
      --card2: rgba(18,28,48,.50);
      --stroke: rgba(255,255,255,.10);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --chip: rgba(255,255,255,.10);
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius: 22px;

      --accent: rgba(99,102,241,.75);
      --accent2: rgba(56,189,248,.70);

      --musicTitleMode: 0; /* 0 white, 1 black, 2 rainbow */
    }
    [data-theme="light"]{
      --bg: #e9eef8;
      --card: rgba(255,255,255,.78);
      --card2: rgba(255,255,255,.62);
      --stroke: rgba(20,20,20,.10);
      --text: rgba(10,10,10,.92);
      --muted: rgba(20,20,20,.62);
      --chip: rgba(20,20,20,.08);
      --shadow: 0 18px 60px rgba(0,0,0,.18);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color: var(--text);
      background: url("bg.gif") center/cover no-repeat fixed;
      min-height:100vh;
      overflow-x:hidden;
    }

    /* subtle overlay to reduce noise in both modes */
    .bgOverlay{
      position:fixed; inset:0;
      background: radial-gradient(1200px 600px at 20% 10%, rgba(0,0,0,.35), transparent 60%),
                  radial-gradient(900px 700px at 80% 30%, rgba(0,0,0,.30), transparent 55%),
                  linear-gradient(to bottom, rgba(0,0,0,.22), rgba(0,0,0,.38));
      pointer-events:none;
      z-index:0;
    }
    [data-theme="light"] .bgOverlay{
      background: radial-gradient(1200px 600px at 20% 10%, rgba(255,255,255,.55), transparent 60%),
                  radial-gradient(900px 700px at 80% 30%, rgba(255,255,255,.45), transparent 55%),
                  linear-gradient(to bottom, rgba(255,255,255,.30), rgba(255,255,255,.15));
    }

    .wrap{
      position:relative;
      z-index:1;
      width:min(1100px, 92vw);
      margin: 28px auto 60px;
    }

    .topbar{
      display:flex;
      gap:10px;
      justify-content:flex-end;
      align-items:center;
      margin-bottom:10px;
    }

    .pillBtn{
      border:1px solid var(--stroke);
      background: rgba(0,0,0,.25);
      color: var(--text);
      padding:10px 14px;
      border-radius: 999px;
      cursor:pointer;
      box-shadow: 0 10px 25px rgba(0,0,0,.18);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      font-weight:600;
      display:flex; gap:8px; align-items:center;
    }
    [data-theme="light"] .pillBtn{ background: rgba(255,255,255,.55); }

    /* main card */
    .card{
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid var(--stroke);
      overflow:hidden;
      background: var(--card);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
    }

    /* cover */
    .cover{
      height: 240px;
      background: url("cover.gif") center/cover no-repeat;
      position:relative;
    }
    .cover::after{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(to bottom, rgba(0,0,0,.15), rgba(0,0,0,.45));
    }

    /* header section like facebook */
    .header{
      display:grid;
      grid-template-columns: 260px 1fr;
      gap: 16px;
      padding: 18px 22px 10px;
      align-items:end;
      position:relative;
    }

    .avatarCol{
      position:relative;
      margin-top: -92px; /* overlaps cover like FB */
      padding-left: 6px;
    }

    /* avatar wrap uses your effect.css sizing idea */
    .avatar-wrap{
      position:relative;
      width:210px;
      height:210px;
    }
    .avatar{
      position:absolute;
      inset:28px;
      width:154px;
      height:154px;
      border-radius:50%;
      object-fit:cover;
      z-index:2;
      background:#0b1220;
      box-shadow: 0 18px 50px rgba(0,0,0,.38);
    }
    .frame{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      z-index:3;
      pointer-events:none;
      filter: drop-shadow(0 0 14px rgba(120,180,255,.45));
    }
    .ring{
      position:absolute;
      inset:-12px;
      border-radius:50%;
      z-index:1;
      pointer-events:none;
      background:
        radial-gradient(circle at 30% 30%, rgba(56,189,248,.34), transparent 48%),
        radial-gradient(circle at 70% 70%, rgba(99,102,241,.26), transparent 55%);
      filter: blur(7px);
      opacity:.85;
      animation: ringPulse 2.8s ease-in-out infinite;
    }
    .ring::before,
    .ring::after{
      content:"";
      position:absolute;
      inset:16px;
      border-radius:50%;
      border:2px solid rgba(56,189,248,.18);
      animation: wave 2.2s ease-in-out infinite;
    }
    .ring::after{
      inset:26px;
      border-color: rgba(99,102,241,.14);
      animation-duration: 3.1s;
      animation-direction: reverse;
    }
    @keyframes ringPulse{
      0%,100%{ transform:scale(1); opacity:.70; }
      50%{ transform:scale(1.04); opacity:.95; }
    }
    @keyframes wave{
      0%,100%{ transform:scale(1); opacity:.52; }
      50%{ transform:scale(1.08); opacity:.88; }
    }

    .infoCol{
      padding-bottom: 6px;
      min-width:0;
    }

    .name{
      font-size: clamp(26px, 2.6vw, 40px);
      margin:0;
      line-height:1.05;
      font-weight: 800;
      text-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    .role{
      margin: 6px 0 0;
      color: var(--muted);
      font-weight:600;
    }
    .quote{
      margin: 8px 0 12px;
      color: var(--muted);
      font-style: italic;
    }

    .chips{
      display:flex; flex-wrap:wrap;
      gap:10px;
      margin: 6px 0 0;
    }
    .chip{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 12px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: var(--chip);
      color: var(--text);
      font-weight:700;
      font-size: 14px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    /* music block under avatar (your request) */
    .musicBox{
      margin-top: 14px;
      border: 1px solid var(--stroke);
      background: var(--card2);
      border-radius: 18px;
      padding: 12px 12px 10px;
      box-shadow: 0 14px 40px rgba(0,0,0,.20);
    }
    .musicHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }
    .musicTitle{
      font-weight: 900;
      font-size: 18px;
      letter-spacing:.2px;
      margin:0;
    }
    .musicTitle.mode-white{ color: rgba(255,255,255,.94); }
    [data-theme="light"] .musicTitle.mode-white{ color: rgba(10,10,10,.92); } /* still readable */
    .musicTitle.mode-black{ color: rgba(10,10,10,.92); }
    [data-theme="light"] .musicTitle.mode-black{ color: rgba(10,10,10,.92); }

    .musicTitle.mode-rainbow{
      background: linear-gradient(90deg, #ff4d4d, #ffcc00, #3cff88, #3cc7ff, #7b61ff, #ff4ddb);
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
      filter: drop-shadow(0 8px 22px rgba(0,0,0,.35));
    }

    .musicSub{
      color: var(--muted);
      font-weight:600;
      font-size: 13px;
      margin:0 0 10px;
    }
    .audio{
      width:100%;
      border-radius: 14px;
      overflow:hidden;
    }

    /* grid content */
    .content{
      padding: 10px 22px 22px;
    }
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
      margin-top: 14px;
    }

    .box{
      border: 1px solid var(--stroke);
      background: var(--card2);
      border-radius: 18px;
      padding: 16px;
      box-shadow: 0 14px 40px rgba(0,0,0,.18);
      min-width:0;
    }
    .box h3{
      margin:0 0 10px;
      font-size: 18px;
      font-weight: 900;
    }
    .list{
      margin:0;
      padding-left: 18px;
      color: var(--text);
      font-weight: 650;
      line-height: 1.7;
    }
    .list span{ color: var(--muted); font-weight:600; }

    .games{
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .gameRow{
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.14);
      border-radius: 16px;
      padding: 12px 12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
    }
    [data-theme="light"] .gameRow{ background: rgba(255,255,255,.35); }
    .gameLeft{
      min-width:0;
    }
    .gameName{
      font-weight:900;
      margin:0;
    }
    .gameMeta{
      margin:2px 0 0;
      color: var(--muted);
      font-weight:650;
      font-size: 13px;
    }
    .tag{
      border: 1px solid rgba(56,189,248,.35);
      background: rgba(56,189,248,.18);
      padding: 8px 12px;
      border-radius: 999px;
      font-weight:900;
      font-size: 13px;
      white-space:nowrap;
    }

    .gameLink{
      display:inline-flex;
      gap:8px;
      align-items:center;
      margin-top:6px;
      font-size: 13px;
      font-weight: 800;
      color: rgba(56,189,248,.95);
      text-decoration:none;
    }
    .gameLink:hover{ text-decoration: underline; }

    /* contact buttons */
    .contacts{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 14px;
    }
    .linkBtn{
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.16);
      border-radius: 18px;
      padding: 14px 16px;
      display:flex;
      justify-content:center;
      align-items:center;
      gap:10px;
      font-weight: 900;
      cursor:pointer;
      color: var(--text);
      text-decoration:none;
      box-shadow: 0 14px 40px rgba(0,0,0,.18);
    }
    [data-theme="light"] .linkBtn{ background: rgba(255,255,255,.35); }
    .linkBtn:hover{ transform: translateY(-1px); }
    .smallNote{
      color: var(--muted);
      font-weight:650;
      margin: 8px 0 0;
      font-size: 13px;
    }

    /* tus section */
    .tusHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin: 8px 0 10px;
    }
    .tusTitle{
      margin:0;
      font-weight: 950;
      font-size: 20px;
    }
    .tusSub{
      margin:3px 0 0;
      color: var(--muted);
      font-weight:650;
      font-size: 13px;
    }

    .btn{
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.18);
      color: var(--text);
      padding: 10px 14px;
      border-radius: 14px;
      cursor:pointer;
      font-weight: 900;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    [data-theme="light"] .btn{ background: rgba(255,255,255,.42); }
    .btn:hover{ transform: translateY(-1px); }

    .tusList{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top: 10px;
    }
    .tusItem{
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.12);
      border-radius: 16px;
      padding: 12px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    [data-theme="light"] .tusItem{ background: rgba(255,255,255,.35); }

    .tusLeft{ min-width:0; }
    .tusName{ margin:0; font-weight:950; }
    .tusUrl{
      margin:4px 0 0;
      color: rgba(56,189,248,.95);
      font-weight:800;
      font-size: 13px;
      text-decoration:none;
      word-break: break-all;
    }
    .tusUrl:hover{ text-decoration:underline; }

    .danger{
      border-color: rgba(239,68,68,.35);
      background: rgba(239,68,68,.14);
    }

    /* admin modal */
    .modalBack{
      position:fixed; inset:0;
      background: rgba(0,0,0,.52);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 16px;
      z-index:50;
    }
    .modal{
      width: min(860px, 95vw);
      background: rgba(255,255,255,.92);
      border-radius: 18px;
      padding: 16px;
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
      color: #111;
    }
    .modalTop{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-bottom:10px;
    }
    .modalTop h2{ margin:0; font-size: 22px; font-weight: 950; }
    .xBtn{
      border: 1px solid rgba(0,0,0,.10);
      background: rgba(255,255,255,.8);
      padding: 10px 12px;
      border-radius: 14px;
      cursor:pointer;
      font-weight: 900;
    }

    .field{
      display:flex;
      flex-direction:column;
      gap:8px;
      margin: 10px 0;
    }
    .field label{
      font-weight: 900;
      color:#222;
    }
    .field input, .field select{
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.15);
      outline:none;
      font-weight: 800;
    }
    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .hint{
      font-weight:800;
      color:#444;
      font-size: 13px;
    }

    .adminOnly{ display:none; }

    /* responsive */
    @media (max-width: 920px){
      .header{ grid-template-columns: 1fr; }
      .avatarCol{ margin-top: -98px; display:flex; justify-content:flex-start; }
      .grid{ grid-template-columns: 1fr; }
      .contacts{ grid-template-columns: 1fr; }
    }
    @media (max-width: 520px){
      .cover{ height: 210px; }
      .avatar-wrap{ transform: scale(.92); transform-origin:left top; }
    }
  </style>

  <!-- keep your existing effect.css if you want (optional) -->
  <link rel="stylesheet" href="effect.css">
</head>

<body>
  <div class="bgOverlay"></div>

  <div class="wrap">
    <div class="topbar">
      <button class="pillBtn" id="themeBtn">üåô <span id="themeText">Dark</span></button>
      <button class="pillBtn" id="adminBtn">üîí Admin</button>
    </div>

    <div class="card">
      <div class="cover"></div>

      <div class="header">
        <div class="avatarCol">
          <div class="avatar-wrap">
            <div class="ring"></div>
            <img class="avatar" src="avatar.jpg" alt="avatar">
            <img class="frame" src="frame.png" alt="frame">
          </div>

          <!-- MUSIC under avatar -->
          <div class="musicBox">
            <div class="musicHead">
              <p class="musicTitle" id="musicTitle">Ai ngo√†i anh</p>
            </div>
            <p class="musicSub" id="musicSub">B·∫•m Play ƒë·ªÉ nghe üéß</p>

            <audio class="audio" id="player" controls preload="metadata">
              <source src="music.mp3" type="audio/mpeg">
            </audio>
          </div>
        </div>

        <div class="infoCol">
          <h1 class="name">Milo Pha ƒê√° (Nhat boy)</h1>
          <p class="role">IT Student ‚Ä¢ Software Engineering</p>
          <p class="quote">‚ÄúM·ªôt g√≥c nh·ªè tr√™n Internet c·ªßa Milo.‚Äù</p>

          <div class="chips">
            <div class="chip">üìç H·ªì Ch√≠ Minh</div>
            <div class="chip">üéÇ 19</div>
            <div class="chip">üéÆ <span id="devVibesText">gamer</span></div>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="grid">
          <div class="box">
            <h3>Gi·ªõi thi·ªáu</h3>
            <ul class="list">
              <li>‚ú® Ch·∫°y Ngay ƒêi</li>
              <li>üß∏ Ch·∫°y V√†o Tr√°i Tim Em</li>
              <li>üòµ ƒê√πa Th√¥i Anh L√†m G√¨ C√≥ Em</li>
            </ul>
          </div>

          <div class="box">
            <h3>Game m√¨nh hay ch∆°i</h3>
            <div class="games" id="gamesBox"></div>
          </div>
        </div>

        <div class="contacts">
          <a class="linkBtn" id="fbBtn" href="#" target="_blank" rel="noopener">üåê Facebook</a>
          <a class="linkBtn" id="dcBtn" href="#" target="_blank" rel="noopener">üéÆ Discord</a>
        </div>

        <div class="box" style="margin-top:14px;">
          <div class="tusHead">
            <div>
              <h3 class="tusTitle">üìù ƒê√¢y l√† n∆°i check c√°c tus c·ªßa t√¥i</h3>
              <p class="tusSub">Ng∆∞·ªùi xem ch·ªâ b·∫•m link ‚Ä¢ Admin m·ªõi th√™m/x√≥a üîí</p>
            </div>
            <button class="btn adminOnly" id="addTusBtn">‚ûï Th√™m link</button>
          </div>

          <div class="tusList" id="tusList"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ADMIN MODAL -->
  <div class="modalBack" id="modalBack">
    <div class="modal">
      <div class="modalTop">
        <h2>üîí Admin Panel</h2>
        <button class="xBtn" id="closeModal">‚úñ</button>
      </div>

      <div id="loginBox">
        <div class="field" style="max-width:420px;">
          <label>Nh·∫≠p m·∫≠t kh·∫©u admin</label>
          <div style="display:flex; gap:10px; align-items:center;">
            <input id="passInput" type="password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u‚Ä¶" autocomplete="current-password" style="flex:1;">
            <button class="btn" id="togglePass" type="button">üëÅÔ∏è</button>
          </div>
          <div class="hint" id="loginHint"></div>
        </div>
        <button class="btn" id="loginBtn">‚úÖ V√†o Admin</button>
      </div>

      <div id="adminBox" style="display:none;">
        <div class="row">
          <div class="field">
            <label>Link Facebook (d√°n link profile c·ªßa b·∫°n)</label>
            <input id="fbInput" placeholder="https://facebook.com/..." />
            <div class="hint">Ng∆∞·ªùi xem b·∫•m Facebook l√† m·ªü link n√†y.</div>
          </div>
          <div class="field">
            <label>Discord ID (ch·ªâ c·∫ßn ID)</label>
            <input id="dcInput" placeholder="9103..." />
            <div class="hint">T·ª± build link: discord.com/users/ID</div>
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label>T√™n b√†i nh·∫°c hi·ªÉn th·ªã</label>
            <input id="musicNameInput" placeholder="Ai ngo√†i anh" />
          </div>
          <div class="field">
            <label>M√†u ch·ªØ t√™n nh·∫°c</label>
            <select id="musicColorMode">
              <option value="0">Tr·∫Øng</option>
              <option value="1">ƒêen</option>
              <option value="2">7 s·∫Øc c·∫ßu v·ªìng üåà</option>
            </select>
          </div>
        </div>

        <div class="field">
          <label>Link cho t·ª´ng game (ƒë·ªÉ ng∆∞·ªùi xem b·∫•m v√†o)</label>
          <div class="hint">B·∫°n s·ª≠a link game ·ªü ƒë√¢y, kh·ªèi code l·∫°i.</div>
        </div>
        <div class="row" id="gameLinkEditors"></div>

        <div class="field">
          <label>Th√™m tus m·ªõi</label>
          <input id="tusTitleInput" placeholder="T√™n tus (vd: Tus AV)" />
          <input id="tusUrlInput" placeholder="D√°n link tus Facebook..." />
          <button class="btn" id="saveTusBtn">‚ûï L∆∞u tus</button>
          <div class="hint">Tus s·∫Ω hi·ªán cho m·ªçi ng∆∞·ªùi b·∫•m m·ªü tr·ª±c ti·∫øp.</div>
        </div>

        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button class="btn" id="saveAdminBtn">üíæ L∆∞u c√†i ƒë·∫∑t</button>
          <button class="btn danger" id="logoutBtn">üö™ Tho√°t Admin</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const $ = (id)=>document.getElementById(id);

    // ====== STORAGE ======
    const KEY = "milo_profile_v1";
    const DEFAULT = {
      theme: "dark",
      fbLink: "https://facebook.com/",
      discordId: "910327589309145109",
      musicTitle: "Ai ngo√†i anh",
      musicColorMode: 2,
      tus: [
        { title: "Tus AV", url: "https://www.facebook.com/" }
      ],
      games: [
        { name:"Roblox", meta:"chill / sandbox", tag:"casual", link:"" },
        { name:"Valorant", meta:"FPS / tryhard", tag:"rank", link:"" },
        { name:"TFT", meta:"auto chess", tag:"brain", link:"" }
      ]
    };

    function loadData(){
      try{
        const raw = localStorage.getItem(KEY);
        if(!raw) return structuredClone(DEFAULT);
        const obj = JSON.parse(raw);
        return { ...structuredClone(DEFAULT), ...obj };
      }catch(e){
        return structuredClone(DEFAULT);
      }
    }
    function saveData(){
      localStorage.setItem(KEY, JSON.stringify(state));
    }

    let state = loadData();
    let isAdmin = false;

    // ====== THEME ======
    function applyTheme(){
      document.documentElement.setAttribute("data-theme", state.theme === "light" ? "light" : "dark");
      const isLight = state.theme === "light";
      $("themeText").textContent = isLight ? "Light" : "Dark";
      $("themeBtn").firstChild.textContent = isLight ? "‚òÄÔ∏è " : "üåô ";
    }

    $("themeBtn").addEventListener("click", ()=>{
      state.theme = (state.theme === "dark") ? "light" : "dark";
      saveData();
      applyTheme();
      applyMusicTitleStyle();
    });

    // ====== LINKS ======
    function applyLinks(){
      // facebook
      $("fbBtn").href = state.fbLink || "https://facebook.com/";
      // discord
      const id = (state.discordId || "").trim();
      $("dcBtn").href = id ? ("https://discord.com/users/" + encodeURIComponent(id)) : "https://discord.com/";
    }

    // ====== MUSIC ======
    function applyMusic(){
      $("musicTitle").textContent = state.musicTitle || "T√™n b√†i c·ªßa t√¥i";
      applyMusicTitleStyle();
      // source fixed to music.mp3 (replace file but keep same name)
      const audio = $("player");
      // force reload metadata if needed
      audio.load();
    }
    function applyMusicTitleStyle(){
      const el = $("musicTitle");
      el.classList.remove("mode-white","mode-black","mode-rainbow");

      const mode = Number(state.musicColorMode ?? 0);
      if(mode === 1){
        el.classList.add("mode-black");
      }else if(mode === 2){
        el.classList.add("mode-rainbow");
      }else{
        el.classList.add("mode-white");
      }
    }

    // ====== GAMES ======
    function renderGames(){
      const box = $("gamesBox");
      box.innerHTML = "";
      state.games.forEach((g, idx)=>{
        const row = document.createElement("div");
        row.className = "gameRow";

        const left = document.createElement("div");
        left.className = "gameLeft";
        left.innerHTML = `
          <p class="gameName">üïπÔ∏è ${escapeHtml(g.name)}</p>
          <p class="gameMeta">${escapeHtml(g.meta || "")}</p>
          ${g.link ? `<a class="gameLink" href="${escapeAttr(g.link)}" target="_blank" rel="noopener">üîó Link t√†i kho·∫£n</a>` : ``}
        `;

        const tag = document.createElement("div");
        tag.className = "tag";
        tag.textContent = g.tag || "tag";

        row.appendChild(left);
        row.appendChild(tag);

        box.appendChild(row);
      });
    }

    // ====== TUS ======
    function renderTus(){
      const list = $("tusList");
      list.innerHTML = "";

      state.tus.forEach((t, idx)=>{
        const item = document.createElement("div");
        item.className = "tusItem";

        const left = document.createElement("div");
        left.className = "tusLeft";
        left.innerHTML = `
          <p class="tusName">${escapeHtml(t.title || "Tus")}</p>
          <a class="tusUrl" href="${escapeAttr(t.url || "#")}" target="_blank" rel="noopener">${escapeHtml(t.url || "")}</a>
        `;

        const right = document.createElement("div");
        if(isAdmin){
          const del = document.createElement("button");
          del.className = "btn danger";
          del.textContent = "üóëÔ∏è X√≥a";
          del.addEventListener("click", ()=>{
            if(!confirm("X√≥a tus n√†y lu√¥n h·∫£ bro?")) return;
            state.tus.splice(idx,1);
            saveData();
            renderTus();
          });
          right.appendChild(del);
        }

        item.appendChild(left);
        item.appendChild(right);
        list.appendChild(item);
      });
    }

    // ====== ADMIN UI ======
    function openModal(){
      $("modalBack").style.display = "flex";
      $("loginHint").textContent = "";
    }
    function closeModal(){
      $("modalBack").style.display = "none";
    }
    $("adminBtn").addEventListener("click", openModal);
    $("closeModal").addEventListener("click", closeModal);
    $("modalBack").addEventListener("click", (e)=>{
      if(e.target === $("modalBack")) closeModal();
    });

    $("togglePass").addEventListener("click", ()=>{
      const inp = $("passInput");
      inp.type = (inp.type === "password") ? "text" : "password";
    });

    $("loginBtn").addEventListener("click", ()=>{
      const pass = $("passInput").value.trim();
      if(pass === "079268"){
        isAdmin = true;
        $("loginBox").style.display = "none";
        $("adminBox").style.display = "block";
        document.querySelectorAll(".adminOnly").forEach(el=>el.style.display="");
        hydrateAdminForm();
        renderTus();
      }else{
        $("loginHint").textContent = "Sai m·∫≠t kh·∫©u r·ªìi bro üíÄ";
      }
    });

    $("logoutBtn").addEventListener("click", ()=>{
      isAdmin = false;
      $("adminBox").style.display = "none";
      $("loginBox").style.display = "block";
      $("passInput").value = "";
      document.querySelectorAll(".adminOnly").forEach(el=>el.style.display="none");
      renderTus();
    });

    function hydrateAdminForm(){
      $("fbInput").value = state.fbLink || "";
      $("dcInput").value = state.discordId || "";
      $("musicNameInput").value = state.musicTitle || "";
      $("musicColorMode").value = String(state.musicColorMode ?? 0);

      // game link editors
      const editors = $("gameLinkEditors");
      editors.innerHTML = "";
      state.games.forEach((g, idx)=>{
        const wrap = document.createElement("div");
        wrap.className = "field";
        wrap.innerHTML = `
          <label>${escapeHtml(g.name)} - Link t√†i kho·∫£n</label>
          <input data-game-idx="${idx}" value="${escapeAttr(g.link || "")}" placeholder="D√°n link (c√≥ th·ªÉ ƒë·ªÉ tr·ªëng)" />
        `;
        editors.appendChild(wrap);
      });
    }

    $("saveAdminBtn").addEventListener("click", ()=>{
      if(!isAdmin) return alert("Ch·ªâ Admin m·ªõi ch·ªânh nha üîí");

      state.fbLink = $("fbInput").value.trim();
      state.discordId = $("dcInput").value.trim();
      state.musicTitle = $("musicNameInput").value.trim() || "T√™n b√†i c·ªßa t√¥i";
      state.musicColorMode = Number($("musicColorMode").value);

      // save game links
      document.querySelectorAll("[data-game-idx]").forEach(inp=>{
        const idx = Number(inp.getAttribute("data-game-idx"));
        state.games[idx].link = inp.value.trim();
      });

      saveData();
      applyLinks();
      applyMusic();
      renderGames();
      alert("ƒê√£ l∆∞u ‚úÖ");
    });

    $("addTusBtn").addEventListener("click", ()=>{
      if(!isAdmin) return alert("Ch·ªâ Admin m·ªõi th√™m/x√≥a ƒë∆∞·ª£c nha üîí");
      // focus admin modal and scroll to add area
      openModal();
      $("adminBox").style.display = "block";
      $("loginBox").style.display = "none";
      window.setTimeout(()=> $("tusTitleInput").focus(), 50);
    });

    $("saveTusBtn").addEventListener("click", ()=>{
      if(!isAdmin) return alert("Ch·ªâ Admin m·ªõi th√™m/x√≥a ƒë∆∞·ª£c nha üîí");
      const title = $("tusTitleInput").value.trim() || "Tus";
      const url = $("tusUrlInput").value.trim();

      if(!url || !/^https?:\/\//i.test(url)){
        return alert("D√°n link h·ª£p l·ªá (b·∫Øt ƒë·∫ßu b·∫±ng http/https) nha bro üò≠");
      }

      state.tus.unshift({ title, url });
      $("tusTitleInput").value = "";
      $("tusUrlInput").value = "";
      saveData();
      renderTus();
    });

    // ====== helpers ======
    function escapeHtml(s){
      return String(s ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }
    function escapeAttr(s){
      return escapeHtml(s).replaceAll("`","&#096;");
    }

    // ====== INIT ======
    function init(){
      applyTheme();
      applyLinks();
      applyMusic();
      renderGames();
      renderTus();

      // hide admin-only by default
      document.querySelectorAll(".adminOnly").forEach(el=>el.style.display="none");
    }
    init();
  </script>
</body>
</html>
