<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Milo Pha ÄÃ¡</title>
  <link rel="stylesheet" href="effect.css" />
</head>

<body class="dark">
  <div class="bg"></div>

  <div class="wrap">
    <div class="top-actions">
      <div class="pill" id="btnTheme" role="button" aria-label="Toggle theme">
        ğŸŒ™ <span id="themeText">Dark</span>
      </div>
      <div class="pill" id="btnAdmin" role="button" aria-label="Open admin">
        ğŸ”’ <span id="adminText">Admin</span>
      </div>
    </div>

    <!-- HEADER -->
    <div class="card header">
      <img class="cover" src="cover.gif" alt="Cover" />

      <div class="header-inner">
        <div class="avatar-wrap">
          <img class="avatar" src="avatar.jpg" alt="Avatar" />
          <img class="avatar-frame" src="frame.png" alt="" />
        </div>

        <div class="who">
          <h1 class="name" id="nameText">Milo Pha ÄÃ¡ (Nhat boy)</h1>
          <div class="subtitle" id="subtitleText">IT Student â€¢ Software Engineering</div>
          <div class="quote" id="quoteText">â€œMá»™t gÃ³c nhá» trÃªn Internet cá»§a Milo.â€</div>

          <div class="chips">
            <div class="chip">ğŸ“ <span id="cityText">Há»“ ChÃ­ Minh</span></div>
            <div class="chip">ğŸ‚ <span id="ageText">19</span></div>
            <div class="chip">ğŸ® <span id="tagText">gamer</span></div>
          </div>
        </div>
      </div>
    </div>

    <!-- GRID -->
    <div class="grid">
      <div class="card section">
        <div class="h">ğŸ§ Nháº¡c tÃ´i nghe</div>
        <div class="music-title"><span>Äang nghe:</span> <span id="songName">Ai ngoÃ i anh</span></div>
        <p class="p">Báº¥m Play Ä‘á»ƒ nghe ğŸ§</p>
        <div style="height:10px"></div>
        <audio id="audio" controls src="music.mp3"></audio>
      </div>

      <div class="card section">
        <div class="h">ğŸ“Œ Giá»›i thiá»‡u</div>
        <div class="list" id="introList"></div>
      </div>

      <div class="card section">
        <div class="h">ğŸ® Game mÃ¬nh hay chÆ¡i</div>
        <div class="list" id="gameList"></div>
        <p class="help">Admin cÃ³ thá»ƒ dÃ¡n link tÃ i khoáº£n game Ä‘á»ƒ ngÆ°á»i xem báº¥m vÃ o.</p>
      </div>

      <div class="card section">
        <div class="h">ğŸ”— LiÃªn há»‡</div>
        <div class="contacts">
          <a class="contact-btn" id="fbBtn" href="#" target="_blank" rel="noopener">ğŸŒ Facebook</a>
          <a class="contact-btn" id="dcBtn" href="#" target="_blank" rel="noopener">ğŸ’¬ Discord</a>
        </div>
        <p class="help" id="dcHelp">Discord: nháº­p ID lÃ  tá»± táº¡o link profile.</p>
      </div>
    </div>

    <!-- TUS -->
    <div class="card tus-box">
      <div class="tus-head">
        <div>ğŸ“ ÄÃ¢y lÃ  nÆ¡i check cÃ¡c tus cá»§a tÃ´i</div>
        <button class="btn btn-primary" id="btnAddTus">â• ThÃªm tus</button>
      </div>
      <p class="p">NgÆ°á»i xem chá»‰ báº¥m link â€¢ Admin má»›i thÃªm/xoÃ¡ ğŸ”’</p>
      <div class="tus-list" id="tusList"></div>
    </div>

    <!-- SCHEDULE -->
    <div class="card schedule">
      <div class="h">ğŸ“… Lá»‹ch báº­n / ráº£nh</div>
      <p class="p">Set theo tá»«ng ngÃ y trong tuáº§n âœ…</p>
      <div class="day-tabs" id="dayTabs"></div>
      <div id="daySlots"></div>
    </div>
  </div>

  <!-- ADMIN MODAL -->
  <div class="modal" id="adminModal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true">
      <button class="modal-close" id="adminClose" aria-label="Close">âœ•</button>
      <h2 class="modal-title">ğŸ” Admin Panel</h2>

      <div class="field">
        <label>Máº­t kháº©u admin</label>
        <input id="adminPassInput" type="password" placeholder="Nháº­p pass..." />
      </div>

      <div class="modal-actions">
        <button class="btn btn-primary" id="btnLogin">âœ… ÄÄƒng nháº­p</button>
        <button class="btn btn-danger" id="btnLogout">ğŸšª ThoÃ¡t Admin</button>
      </div>

      <hr style="border:none;border-top:1px solid var(--line);margin:14px 0">

      <!-- PHáº¦N NÃ€Y CHá»ˆ HIá»†N KHI ÄÃƒ LOGIN -->
      <div id="adminLocked">
        <div class="row">
          <div class="field">
            <label>Link Facebook (dÃ¡n link profile)</label>
            <input id="fbInput" placeholder="https://facebook.com/..." />
          </div>
          <div class="field">
            <label>Discord ID (chá»‰ cáº§n ID)</label>
            <input id="dcIdInput" placeholder="9103..." />
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label>Link Roblox (tÃ i khoáº£n)</label>
            <input id="robloxInput" placeholder="DÃ¡n link (cÃ³ thá»ƒ Ä‘á»ƒ trá»‘ng)" />
          </div>
          <div class="field">
            <label>Link Valorant (tÃ i khoáº£n / tracker)</label>
            <input id="valoInput" placeholder="DÃ¡n link (cÃ³ thá»ƒ Ä‘á»ƒ trá»‘ng)" />
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label>Link TFT (tÃ i khoáº£n / tracker)</label>
            <input id="tftInput" placeholder="DÃ¡n link (cÃ³ thá»ƒ Ä‘á»ƒ trá»‘ng)" />
          </div>
          <div class="field">
            <label>TÃªn bÃ i nháº¡c hiá»ƒn thá»‹</label>
            <input id="songInput" placeholder="Ai ngoÃ i anh" />
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label>Äá»•i máº­t kháº©u admin (tuá»³ chá»n)</label>
            <input id="newPassInput" placeholder="Äá»ƒ trá»‘ng náº¿u khÃ´ng Ä‘á»•i" />
          </div>
          <div class="field">
            <label>TÃªn hiá»ƒn thá»‹</label>
            <input id="nameInput" placeholder="Milo Pha ÄÃ¡ (Nhat boy)" />
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label>Subtitle</label>
            <input id="subInput" placeholder="IT Student â€¢ Software Engineering" />
          </div>
          <div class="field">
            <label>Quote</label>
            <input id="quoteInput" placeholder="Má»™t gÃ³c nhá»..." />
          </div>
        </div>

        <hr style="border:none;border-top:1px solid var(--line);margin:14px 0">

        <div class="row">
          <div class="field">
            <label>â• ThÃªm tus má»›i (Admin only)</label>
            <input id="tusTitleInput" placeholder="TÃªn tus (vd: Tus AV)" />
            <input id="tusLinkInput" placeholder="DÃ¡n link tus..." />
            <button class="btn btn-ghost" id="btnAddTusAdmin">â• ThÃªm tus</button>
          </div>

          <div class="field">
            <label>ğŸ“… ThÃªm lá»‹ch báº­n/ráº£nh (Admin only)</label>
            <select id="daySelect"></select>
            <div class="row" style="margin-top:0">
              <div class="field">
                <label>Tá»« giá»</label>
                <input id="fromInput" placeholder="09:00" />
              </div>
              <div class="field">
                <label>Äáº¿n giá»</label>
                <input id="toInput" placeholder="11:30" />
              </div>
            </div>
            <textarea id="taskInput" placeholder="Viá»‡c gÃ¬? (vd: Há»c PRF192 / Ä‘i gym / lÃ m bÃ i...)"></textarea>
            <button class="btn btn-ghost" id="btnAddSlot">â• ThÃªm lá»‹ch</button>
          </div>
        </div>

        <div class="modal-actions">
          <button class="btn btn-primary" id="btnSave">ğŸ’¾ LÆ°u cÃ i Ä‘áº·t</button>
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  const LS_KEY = "milo_profile_v3";

  const $ = (id) => document.getElementById(id);

  const defaultState = {
    theme: "dark",
    adminOn: false,
    adminPass: "079268",

    profile: {
      name: "Milo Pha ÄÃ¡ (Nhat boy)",
      subtitle: "IT Student â€¢ Software Engineering",
      quote: "â€œMá»™t gÃ³c nhá» trÃªn Internet cá»§a Milo.â€",
      city: "Há»“ ChÃ­ Minh",
      age: "19",
      tag: "gamer",
      songName: "Ai ngoÃ i anh",
      facebook: "https://www.facebook.com/milo.pha.a",
      discordId: "910327589309145109",
      games: {
        roblox: "",
        valorant: "",
        tft: ""
      },
      intro: [
        "âœ¨ Cháº¡y Ngay Äi",
        "ğŸ§¸ Cháº¡y VÃ o TrÃ¡i Tim Em",
        "ğŸ˜³ ÄÃ¹a ThÃ´i Anh LÃ m GÃ¬ CÃ³ Em"
      ],
      tus: [],
      schedule: {
        "Thá»© 2": [],
        "Thá»© 3": [],
        "Thá»© 4": [],
        "Thá»© 5": [],
        "Thá»© 6": [],
        "Thá»© 7": [],
        "Chá»§ nháº­t": []
      }
    }
  };

  function loadState(){
    try{
      const raw = localStorage.getItem(LS_KEY);
      if(!raw) return structuredClone(defaultState);
      const s = JSON.parse(raw);

      // merge nháº¹ Ä‘á»ƒ khÃ´ng lá»—i khi thiáº¿u field
      const merged = structuredClone(defaultState);
      Object.assign(merged, s);
      merged.profile = Object.assign(structuredClone(defaultState.profile), s.profile || {});
      merged.profile.games = Object.assign(structuredClone(defaultState.profile.games), (s.profile && s.profile.games) || {});
      merged.profile.schedule = Object.assign(structuredClone(defaultState.profile.schedule), (s.profile && s.profile.schedule) || {});
      if(!Array.isArray(merged.profile.intro)) merged.profile.intro = structuredClone(defaultState.profile.intro);
      if(!Array.isArray(merged.profile.tus)) merged.profile.tus = [];
      return merged;
    }catch(e){
      return structuredClone(defaultState);
    }
  }

  function saveState(){
    localStorage.setItem(LS_KEY, JSON.stringify(state));
  }

  function dcLinkFromId(id){
    const clean = (id||"").trim().replace(/\s+/g,"");
    if(!clean) return "#";
    return "https://discord.com/users/" + clean;
  }

  function renderIntro(){
    const box = $("introList");
    box.innerHTML = "";
    state.profile.intro.forEach((t) => {
      const div = document.createElement("div");
      div.className = "item";
      div.innerHTML = `<span>${escapeHtml(t)}</span>`;
      box.appendChild(div);
    });
  }

  function renderGames(){
    const box = $("gameList");
    box.innerHTML = "";

    const items = [
      { key:"roblox", name:"Roblox", sub:"chill / sandbox", tag:"casual" },
      { key:"valorant", name:"Valorant", sub:"FPS / tryhard", tag:"rank" },
      { key:"tft", name:"TFT", sub:"auto chess", tag:"brain" }
    ];

    items.forEach(it => {
      const link = (state.profile.games[it.key] || "").trim();
      const div = document.createElement("div");
      div.className = "item";
      const left = `
        <div style="display:flex;flex-direction:column;gap:3px">
          <div style="font-weight:950">${it.name}</div>
          <div style="font-size:12px;color:var(--muted);font-weight:800">${it.sub}</div>
          <div style="font-size:12px;color:var(--muted);font-weight:800">${link ? "CÃ³ link âœ…" : "ChÆ°a cÃ³ link"}</div>
        </div>
      `;
      const right = `<span class="tag">${it.tag}</span>`;
      div.innerHTML = left + right;

      if(link){
        div.style.cursor = "pointer";
        div.addEventListener("click", () => window.open(link, "_blank", "noopener"));
      }
      box.appendChild(div);
    });
  }

  function renderContacts(){
    const fb = (state.profile.facebook || "").trim();
    $("fbBtn").href = fb ? fb : "#";

    const dc = dcLinkFromId(state.profile.discordId);
    $("dcBtn").href = dc;
  }

  function renderTus(){
    const box = $("tusList");
    box.innerHTML = "";

    if(state.profile.tus.length === 0){
      const empty = document.createElement("div");
      empty.className = "tus-link";
      empty.href = "#";
      empty.innerHTML = `<span>ChÆ°a cÃ³ tus nÃ o ğŸ˜³</span><span class="tag">trá»‘ng</span>`;
      box.appendChild(empty);
      return;
    }

    state.profile.tus.forEach((t, idx) => {
      const a = document.createElement("a");
      a.className = "tus-link";
      a.href = t.link || "#";
      a.target = "_blank";
      a.rel = "noopener";
      a.innerHTML = `<span>ğŸ”— ${escapeHtml(t.title || ("Tus "+(idx+1)))}</span><span class="tag">Má»Ÿ</span>`;
      box.appendChild(a);
    });
  }

  function renderScheduleTabs(){
    const days = Object.keys(state.profile.schedule);
    const tabs = $("dayTabs");
    tabs.innerHTML = "";
    days.forEach((d) => {
      const b = document.createElement("div");
      b.className = "tab";
      b.textContent = d;
      b.addEventListener("click", () => {
        state.currentDay = d;
        renderSchedule();
      });
      tabs.appendChild(b);
    });
    if(!state.currentDay) state.currentDay = days[0];
  }

  function renderSchedule(){
    const days = Object.keys(state.profile.schedule);
    const tabs = $("dayTabs").querySelectorAll(".tab");
    tabs.forEach((t, i) => {
      t.classList.toggle("active", days[i] === state.currentDay);
    });

    const slotsBox = $("daySlots");
    slotsBox.innerHTML = "";

    const arr = state.profile.schedule[state.currentDay] || [];
    if(arr.length === 0){
      const div = document.createElement("div");
      div.className = "slot";
      div.innerHTML = `<div class="slot-left">
        <div class="slot-title">ğŸ˜´ ChÆ°a cÃ³ lá»‹ch cho ${escapeHtml(state.currentDay)}.</div>
        <div class="slot-time">Báº¡n Ä‘ang ráº£nh Ä‘Ã³ âœ…</div>
      </div>`;
      slotsBox.appendChild(div);
      return;
    }

    arr.forEach((s) => {
      const div = document.createElement("div");
      div.className = "slot";
      div.innerHTML = `
        <div class="slot-left">
          <div class="slot-title">${escapeHtml(s.task || "Viá»‡c báº­n")}</div>
          <div class="slot-time">${escapeHtml(s.from || "--:--")} â†’ ${escapeHtml(s.to || "--:--")}</div>
        </div>
        <span class="tag">báº­n</span>
      `;
      slotsBox.appendChild(div);
    });
  }

  function applyProfileToUI(){
    $("nameText").textContent = state.profile.name || "";
    $("subtitleText").textContent = state.profile.subtitle || "";
    $("quoteText").textContent = state.profile.quote || "";
    $("cityText").textContent = state.profile.city || "";
    $("ageText").textContent = state.profile.age || "";
    $("tagText").textContent = state.profile.tag || "";
    $("songName").textContent = state.profile.songName || "";

    renderIntro();
    renderGames();
    renderContacts();
    renderTus();
    renderScheduleTabs();
    renderSchedule();
  }

  function applyTheme(){
    document.body.classList.toggle("light", state.theme === "light");
    document.body.classList.toggle("dark", state.theme !== "light");
    $("themeText").textContent = (state.theme === "light") ? "Light" : "Dark";
  }

  function setAdmin(on){
    state.adminOn = !!on;
    document.body.classList.toggle("admin-on", state.adminOn);
  }

  function openModal(){
    $("adminModal").classList.add("show");
    $("adminModal").setAttribute("aria-hidden", "false");
  }
  function closeModal(){
    $("adminModal").classList.remove("show");
    $("adminModal").setAttribute("aria-hidden", "true");
  }

  function fillAdminInputs(){
    $("fbInput").value = state.profile.facebook || "";
    $("dcIdInput").value = state.profile.discordId || "";
    $("robloxInput").value = state.profile.games.roblox || "";
    $("valoInput").value = state.profile.games.valorant || "";
    $("tftInput").value = state.profile.games.tft || "";
    $("songInput").value = state.profile.songName || "";
    $("nameInput").value = state.profile.name || "";
    $("subInput").value = state.profile.subtitle || "";
    $("quoteInput").value = state.profile.quote || "";

    const daySelect = $("daySelect");
    daySelect.innerHTML = "";
    Object.keys(state.profile.schedule).forEach(d => {
      const opt = document.createElement("option");
      opt.value = d;
      opt.textContent = d;
      daySelect.appendChild(opt);
    });
  }

  function saveFromAdmin(){
    state.profile.facebook = $("fbInput").value.trim();
    state.profile.discordId = $("dcIdInput").value.trim();
    state.profile.games.roblox = $("robloxInput").value.trim();
    state.profile.games.valorant = $("valoInput").value.trim();
    state.profile.games.tft = $("tftInput").value.trim();
    state.profile.songName = $("songInput").value.trim() || state.profile.songName;

    state.profile.name = $("nameInput").value.trim() || state.profile.name;
    state.profile.subtitle = $("subInput").value.trim() || state.profile.subtitle;
    state.profile.quote = $("quoteInput").value.trim() || state.profile.quote;

    const newPass = $("newPassInput").value.trim();
    if(newPass) state.adminPass = newPass;

    saveState();
    applyProfileToUI();
  }

  function escapeHtml(str){
    return String(str || "")
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  // ---------------- init ----------------
  let state = loadState();

  // theme button
  $("btnTheme").addEventListener("click", () => {
    state.theme = (state.theme === "light") ? "dark" : "light";
    applyTheme();
    saveState();
  });

  // admin open
  $("btnAdmin").addEventListener("click", () => {
    openModal();
    fillAdminInputs();
    $("adminPassInput").value = "";
  });

  $("adminClose").addEventListener("click", closeModal);
  $("adminModal").addEventListener("click", (e) => {
    if(e.target === $("adminModal")) closeModal();
  });

  // login/logout
  $("btnLogin").addEventListener("click", () => {
    const pass = $("adminPassInput").value.trim();
    if(pass === state.adminPass){
      setAdmin(true);
      fillAdminInputs();
    }else{
      alert("Sai máº­t kháº©u ğŸ˜­");
      setAdmin(false);
    }
  });

  $("btnLogout").addEventListener("click", () => {
    setAdmin(false);
    $("adminPassInput").value = "";
  });

  // save settings
  $("btnSave").addEventListener("click", () => {
    if(!state.adminOn){
      alert("Báº¡n chÆ°a Ä‘Äƒng nháº­p admin ğŸ”’");
      return;
    }
    saveFromAdmin();
    alert("ÄÃ£ lÆ°u âœ…");
  });

  // add tus (admin only)
  $("btnAddTusAdmin").addEventListener("click", () => {
    if(!state.adminOn){
      alert("Cáº§n quyá»n admin ğŸ”’");
      return;
    }
    const title = $("tusTitleInput").value.trim();
    const link = $("tusLinkInput").value.trim();
    if(!title || !link){
      alert("Nháº­p Ä‘á»§ tÃªn tus + link nha ğŸ˜…");
      return;
    }
    state.profile.tus.unshift({ title, link });
    $("tusTitleInput").value = "";
    $("tusLinkInput").value = "";
    saveState();
    renderTus();
  });

  // viewer add tus button (admin only)
  $("btnAddTus").addEventListener("click", () => {
    if(!state.adminOn){
      alert("Chá»‰ admin má»›i thÃªm Ä‘Æ°á»£c ğŸ”’");
      return;
    }
    openModal();
    fillAdminInputs();
  });

  // add schedule (admin only)
  $("btnAddSlot").addEventListener("click", () => {
    if(!state.adminOn){
      alert("Cáº§n quyá»n admin ğŸ”’");
      return;
    }
    const day = $("daySelect").value;
    const from = $("fromInput").value.trim();
    const to = $("toInput").value.trim();
    const task = $("taskInput").value.trim();
    if(!day || !from || !to || !task){
      alert("Nháº­p Ä‘á»§ ngÃ y + tá»« giá» + Ä‘áº¿n giá» + viá»‡c ğŸ˜…");
      return;
    }
    if(!Array.isArray(state.profile.schedule[day])) state.profile.schedule[day] = [];
    state.profile.schedule[day].push({ from, to, task });
    $("taskInput").value = "";
    saveState();
    renderSchedule();
  });

  // initial apply
  applyTheme();
  setAdmin(!!state.adminOn);
  applyProfileToUI();
})();
</script>
</body>
</html>
